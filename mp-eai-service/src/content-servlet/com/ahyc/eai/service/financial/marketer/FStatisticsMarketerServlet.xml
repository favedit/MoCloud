<?xml version="1.0" encoding="UTF-8" ?>

<Config>

<Resource name='sql.dynamic.sum'>
SELECT
   SUM(INVESTMENT) INVESTMENT_COUNT,
   MAX(INVESTMENT_TOTAL) INVESTMENT_TOTAL,
   SUM(CUSTOMER_COUNT) CUSTOMER_COUNT,
   MAX(CUSTOMER_TOTAL) CUSTOMER_TOTAL
FROM ST_FIN_PHASE
WHERE RECORD_DAY = {date}
</Resource>

<Resource name='sql.dynamic.rank.day'>
SELECT * FROM (
   SELECT
      DEPARTMENT_ID,
      DEPARTMENT_LABEL,
      MARKETER_ID,
      MARKETER_LABEL,
      SUM(MARKETER_INVESTMENT) INVESTMENT_TOTAL,
      SUM(CUSTOMER_COUNT) CUSTOMER_COUNT,
      MAX(CUSTOMER_TOTAL) CUSTOMER_TOTAL
   FROM ST_FIN_MARKETER_PHASE
   WHERE RECORD_DAY = {date}
   GROUP BY MARKETER_ID
) t
ORDER BY INVESTMENT_TOTAL DESC
LIMIT 3
</Resource>

<Resource name='sql.dynamic.rank.week'>
SELECT * FROM (
   SELECT
      DEPARTMENT_ID,
      DEPARTMENT_LABEL,
      MARKETER_ID,
      MARKETER_LABEL,
      SUM(MARKETER_INVESTMENT) INVESTMENT_TOTAL,
      SUM(CUSTOMER_COUNT) CUSTOMER_COUNT,
      MAX(CUSTOMER_TOTAL) CUSTOMER_TOTAL
   FROM ST_FIN_MARKETER_PHASE
   WHERE RECORD_WEEK = {date}
   GROUP BY MARKETER_ID
) t
ORDER BY INVESTMENT_TOTAL DESC
LIMIT 3
</Resource>

<Resource name='sql.dynamic.rank.month'>
SELECT * FROM (
   SELECT
      DEPARTMENT_ID,
      DEPARTMENT_LABEL,
      MARKETER_ID,
      MARKETER_LABEL,
      SUM(MARKETER_INVESTMENT) INVESTMENT_TOTAL,
      SUM(CUSTOMER_COUNT) CUSTOMER_COUNT,
      MAX(CUSTOMER_TOTAL) CUSTOMER_TOTAL
   FROM ST_FIN_MARKETER_PHASE
   WHERE RECORD_MONTH = {date}
   GROUP BY MARKETER_ID
) t
ORDER BY INVESTMENT_TOTAL DESC
LIMIT 3
</Resource>

</Config>