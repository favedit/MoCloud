<?xml version="1.0" encoding="UTF-8" ?>

<Config>

<Resource name='sql.achievement.day'>
SELECT
   RECORD_HOUR,
   SUM(INVESTMENT) INVESTMENT_AMOUNT,
   SUM(REDEMPTION) REDEMPTION_AMOUNT,
   SUM(CUSTOMER_COUNT) CUSTOMER_COUNT
FROM ST_FIN_PHASE
WHERE RECORD_DAY = {date}
GROUP BY RECORD_HOUR
ORDER BY RECORD_HOUR
</Resource>

<Resource name='sql.achievement.month'>
SELECT
   RECORD_DAY,
   SUM(INVESTMENT) INVESTMENT_AMOUNT,
   SUM(REDEMPTION) REDEMPTION_AMOUNT,
   SUM(CUSTOMER_COUNT) CUSTOMER_COUNT
FROM ST_FIN_PHASE
WHERE RECORD_MONTH = {date}
GROUP BY RECORD_DAY
ORDER BY RECORD_DAY
</Resource>

<Resource name='sql.achievement.year'>
SELECT
   MIN(RECORD_DAY) RECORD_DAY,
   DATE_FORMAT(RECORD_DAY, '%w') WEEK_DAY,
   SUM(INVESTMENT) INVESTMENT_AMOUNT,
   SUM(REDEMPTION) REDEMPTION_AMOUNT,
   SUM(CUSTOMER_COUNT) CUSTOMER_COUNT
FROM ST_FIN_PHASE
WHERE (RECORD_YEAR = {prior_date}) OR (RECORD_YEAR = {date})
GROUP BY DATE_FORMAT(RECORD_DAY, '%Y%v')
ORDER BY RECORD_DAY
</Resource>

</Config>
